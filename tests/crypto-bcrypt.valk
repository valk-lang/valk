
use valk:crypto

test "Bcrypt" {

    // Verify
    assert(crypto:bcrypt_verify("abc", "$2a$12$UcoDpE233858bHsqPs19su4uxn2vwmg0pGDIhezKiK475V7odJaCe"))

    // Create + Verify
    let hash = crypto:bcrypt_hash("test")
    assert(crypto:bcrypt_verify("test", hash))

    // Low cost
    hash = crypto:bcrypt_hash("test1", 4)
    assert(crypto:bcrypt_verify("test1", hash))
}
