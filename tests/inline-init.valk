
struct IIS1 {
    v1: <IIS2> ({ v: 5 })
    v2: <IIS2> ({ v: 10 })
    v3: <IIS2>
    v4: uint (20)
    v5: [u8 x 2] ({ 6, 7 })
}
struct IIS2 {
    v: int
}
class InlineInit {
    v: <IIS1>
}

global inline_g1 : <IIS1> ({ v3: { v: 17 } })
global inline_g2 : [u8 x 2] ({ 8, 9 })
global inline_g3 : [[u8 x 2] x 2] ({ {1, 2}, {3, 4} })

test "Inline init" {

    let v1 = InlineInit {
        v: { v3: { v: 15 } }
    }
    let v2 : <IIS1> = {
        v3: { v: 16 }
    }

    assert(v1.v.v1.v == 5)
    assert(v1.v.v2.v == 10)
    assert(v1.v.v3.v == 15)
    assert(v1.v.v4 == 20)
    assert(v1.v.v5[0] == 6)
    assert(v1.v.v5[1] == 7)

    assert(v2.v1.v == 5)
    assert(v2.v2.v == 10)
    assert(v2.v3.v == 16)
    assert(v2.v4 == 20)
    assert(v2.v5[0] == 6)
    assert(v2.v5[1] == 7)

    assert(inline_g1.v1.v == 5)
    assert(inline_g1.v2.v == 10)
    assert(inline_g1.v3.v == 17)
    assert(inline_g1.v4 == 20)
    assert(inline_g1.v5[0] == 6)
    assert(inline_g1.v5[1] == 7)

    assert(inline_g2[0] == 8)
    assert(inline_g2[1] == 9)

    assert(inline_g3[0][0] == 1)
    assert(inline_g3[0][1] == 2)
    assert(inline_g3[1][0] == 3)
    assert(inline_g3[1][1] == 4)
}
