
fn test_fa_arg(x: &[int x 3]) {
    x[0] = 10
    assert(x[1] == 2)
}
fn test_fa_rett() [int x 3] {
    return [1, 2, 5]
}
fn test_fa_arg_rett(x: &[int x 3]) [int x 3] {
    x[0] = 11
    return x
}

test "Flat array in functions" {
    //
    let a = [1, 2, 3]
    test_fa_arg(a)
    assert(a[0] == 10)
    //
    test_fa_arg([1, 2, 3])
    //
    test_fa_arg(test_fa_rett())
    //
    let b = test_fa_rett()
    test_fa_arg(b)
    assert(b[0] == 10)
    assert(b[2] == 5)
    //
    let c = [1, 2, 7]
    let d = test_fa_arg_rett(c)
    assert(c[0] == 11)
    assert(c[2] == 7)
    assert(d[0] == 11)
    assert(d[2] == 7)
    c[1] = 5
    assert(c[1] == 5)
    assert(d[1] == 2)
}

global fa_global : [int x 3] ([1, 2, 3])
struct FAS {
    data: [int x 3]
}

test "Flat array in structs" {
    let a = FAS {
        data: fa_global
    }
    assert(a.data[0] == 1)
    //
    let b = fa_global
    let c = FAS {
        data: b
    }
    assert(c.data[0] == 1)
}