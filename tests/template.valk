
use valk:template
use valk:fs
use valk:html

test "Templates" {

    let data = object { 
        title: "Hello"
        content: object {
            msg: "World"
            attr: "\" class=\"test\""
            xss: "<script>alert('test');</script>"
        }
    }

    let vdir = __DIR__ + "/assets/views"
    let options = template:RenderOptions {
        sanitize: html:sanitize_filter
        template_directory: vdir
    }
    let result = template:render_path(vdir + "/pages/test-page.html", data, options) !? EMSG
    let expect = fs:read(vdir + "/expect/result-1.html") !? "-?-"

    assert(result == expect)
}