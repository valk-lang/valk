
use valk:crypto

test "Blake2b" {

    // Without key
    let hash = crypto:Argon2.hash_str("abc") !? "failed"
    assert(hash == "ba80a53f981c4d0d6a2797b69f12f6e94c212f14685ac4b74b12bb6fdbffa2d17d87c5392aab792dc252d5de4533cc9518d38aa8dbf1925ab92386edd4009923")
    // With key
    hash = crypto:Argon2.hash_str("abc", "test") !? "failed"
    assert(hash == "271aafa177d01c1a96b5db53cacf75fc895f757f3a24cfbacb07d2d737bcf6997dbcf8b2e97bace9842f526208197791996f9d5c557124d2ce3353bf0e263339")
    // Long input
    hash = crypto:Argon2.hash_str("abcabcabcabcabcabc123456789abcabcabcabcabcabc123456789") !? "failed"
    assert(hash == "b6d52f42f810a7b8e8b0e9d794d2aa8dd1f3bda927511045a9efeefb1a8d0f9b26f720da1b0b884ce015375b6fc18a842f84a07e78d457f203046b67fff28489")

}
