
use valk:crypto

test "Blake2b" {

    // Without key
    let hash = crypto:Blake2b.hash_str("abc") !? "failed"
    assert(hash == "ba80a53f981c4d0d6a2797b69f12f6e94c212f14685ac4b74b12bb6fdbffa2d17d87c5392aab792dc252d5de4533cc9518d38aa8dbf1925ab92386edd4009923")
    // With key
    hash = crypto:Blake2b.hash_str("abc", "test") !? "failed"
    assert(hash == "271aafa177d01c1a96b5db53cacf75fc895f757f3a24cfbacb07d2d737bcf6997dbcf8b2e97bace9842f526208197791996f9d5c557124d2ce3353bf0e263339")

}
