
header "sys" as sys

+ class SocketServer {
    ~ socket: Socket

    + fn accept() Connection !too_many_connections !error !closed {

        let sock = this.socket
        if sock.closed : throw closed

        let sock_fd = sock.fd
        let fd = accept(sock_fd, sock.addrinfo) ! throw error

        return Connection.new(fd)
    }

    + fn close() {
        this.socket.close()
    }
}

