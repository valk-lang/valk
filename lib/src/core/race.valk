
shared rlock : MutexStruct[void] (@undefined)
global rlock_count : uint (@undefined)

+ fn race_lock() {
    let count = rlock_count++
    if count == 0 : rlock.lock()
}
+ fn race_unlock() {
    if rlock_count == 0 : return
    let count = --rlock_count
    if count == 0 : rlock.unlock()
}

