
header "sys" as sys

fn write_from_ptr(fd: i32, data: ptr, len: uint) uint !failed !again  {
    #if OS == win
    let bytes = len @as u32
    #else
    let bytes = len
    #end
    let c = sys:write(fd @as i32, data, bytes)
    if c == -2 {
        throw again
    }
    if c < 0 {
        throw failed
    }
    return c @as uint
}
