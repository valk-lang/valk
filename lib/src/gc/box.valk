
use mem

value BOX_COUNT (5)

global box_current: u8 (@undefined)
global box_insert: u8 (@undefined)
global boxes: ptr (@undefined)

fn boxes_init() {

    box_current = 0
    box_insert = 1

    let bb = mem:alloc(BOX_COUNT * sizeof(ptr))
    boxes = bb
    let i : uint = BOX_COUNT
    while i-- > 0 {
        @ptrv(bb, ptr, i) = Bump.new()
    }
}

fn box_insert_item(box: u8, item: ptr) {
    @ptrv(item, u8, byte_box) = box
    let b = @ptrv(boxes, Bump, box)
    b.add_ptr(item)
}